# activate MOLINFO functionalities
MOLINFO STRUCTURE=../../data/diala/dialaA.pdb 
# compute the backbone dihedral angle phi, defined by atoms C-N-CA-C
# you should use MOLINFO shortcuts
phi: TORSION ATOMS=@phi-2
# compute the backbone dihedral angle psi, defined by atoms N-CA-C-N
# here also you should to use MOLINFO shortcuts
psi: TORSION ATOMS=@psi-2
# the difference between the two structures is 0.116584 nm
rA: RMSD REFERENCE=../../data/diala/sA.pdb TYPE=OPTIMAL
rB: RMSD REFERENCE=../../data/diala/sB.pdb TYPE=OPTIMAL
# define progression CV
s: CUSTOM ARG=rA,rB VAR=x,y PERIODIC=NO FUNC=x+y
# activate well-tempered metadynamics in phi
metad: METAD ARG=s ...
  # deposit a Gaussian every 500 time steps, with initial height
  # equal to 1.2 kJ/mol and bias factor equal to 8
  PACE=500 HEIGHT=1.2 BIASFACTOR=8
  # Gaussian width (sigma) should be chosen based on the CV fluctuations in unbiased run
  # try 1/2 or 1/3 of the estimated fluctuations
  SIGMA=0.05
  # Gaussians will be written to file and also stored on grid
  FILE=HILLS GRID_MIN=0 GRID_MAX=3
...
# print both collective variables on COLVAR file every 10 steps
PRINT ARG=phi,psi,rA,rB,s FILE=COLVAR STRIDE=10
